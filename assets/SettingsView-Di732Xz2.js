import{u as B}from"./index-DILutAZZ.js";import{d as w,l as K,r as R,C as J,_ as D,i as g,o as S,b,e as s,w as a,n as r,g as u,c as m,m as G,t as h,u as A,j as C,q as V}from"./index-BPRzL7i-.js";import{H as x}from"./HighChartEarnings-DR0vpFhb.js";import{H as X}from"./HighChartExpensesIncome-B85p9Js0.js";const O=w({name:"CurrencySwitcher",setup(){const c=B(),e=K(),d=R(e.selectedCurrency),U=()=>{e.setCurrency(d.value)};return J(()=>d,()=>{e.setCurrency(d.value)}),J(d,async()=>{c.budget*=e.getRate,e.setCurrency(d.value),c.budget/=e.getRate}),{selectedCurrency:d,updateCurrency:U}}}),T="/finance/assets/belarus-flag-icon-CWWL470t.png",H="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAC7CAIAAAAbo+eAAAAEpElEQVR4Xu3YMWicdRzG8VuzlYyBOKSLGKiLIp3ESZx0c3DqYpdODhWKk5sgFSm0KEgJhoKGipRSEPdGkTRtSIaeYkomuaEEMmU6f3fvcbm8uSbPnPs8fIbkLrnp/fK+/+v0z9r+/v6u2fnd3t7ewcFB+7o/sU77hYnVR9QHVSrtN8zO1+oi73a7dcG335jY9FSa/zw8PGy/YXZ+Vxd8XfavujdMSaXa6vV67VfNZmN18dfDVPvVk6lUVclzm9k5XnM+b714LJV6Wydm/WEtraPLUSq94SbeMpvpVQ6T55ajVOrRa/yzmfWPRzFKpe41vu8ya62iGD+GjVI5eYgxs/7EjWWQyv5wx943s+HqxNJ81zVIxS3F7JQ1z2CDVBzozU5ZE4hUzM5Y89jlAczsjEnFLJpUzKJJxSyaVMyiScUsmlTMoknFLJpUzKJJxSyaVMyiScUsmlTMoknFLJpUzKJJxSyaVMyiScUsmlTMoknFLJpUzKJJxSyaVMyiScUsmlTMoknFLJpUzKJJxSyaVMyiScUsmlTMoknFLJpUzKJJxSyaVMyiScUsmlTMoknFLJpUzKJJxSyaVMyiScUsmlTMoknFLJpUzKJJxSyaVMyiHaXy4sW/rffMbLwmkEEqq7+s37j5JzDVzw/+GKXy5be/dS6udN78EWi7uHLzu98nUqmXLt8D2i6tSgUCUoGIVCAiFYhIBSJSgYhUICIViEgFIlKBiFQgIhWISAUiUoGIVCAiFYhIBSJSgYhUICIViEgFIlKBiFQgIhWISAUiUoGIVCAiFYhIBSJSgYhUICIViEgFIlKBiFQgIhWISAUiUoGIVCAiFYhIBSJSgYhUICIViEgFIlKBiFQgIhWISAUiUoGIVCAiFYhIBSJSgYhUICIViEgFIlKBSDuVS6udyz8BbZOp/PDNvSuvX//0rRtAS6WxemdtlMrG11/tLHT+eeMC0FJpbNy+NZHK4tzO8mtA2+KcVCAgFYhIBSJSgYhUICIViEgFIlKBiFQgIhWISAUiUoGIVCAiFYhIBSJSgYhUICIViEgFIlKBiFQgIhWISAUiUoGIVCAiFYhIBSJSgYhUICIViEgFIlKBiFQgIhWISAUiUoGIVCAiFYhIBSJSgYhUICIViEgFIlKBiFQgciyV27ekAtMtdDZX7o5S2bq/Vr+3/wJYHqSy/ejhKJX6afuCVGCKSuP5+uNRKnt7ex7A4FX+e/lylMrB4eHmlU92luZP/hHMtKX5zWtXK5BRKrU6uDiuQEs9fdVJvmlklErdYp69+7YbCxxZmn/2wXvN09dRKv3h92AO9zBWOTx98Os4kKNU6oHsyfXPPIbBwELnyRefN6eUdir94WPY048/8m0Ys25xrkLo9XqTdRxLpT/84njwbZh7CzOrOvnw/d3d3VYa7VT6w3tL3XoG5xanfGZMXfab16627ifNpqTSH55bth89rOO/YJgJdZEvdLbeWd66vzZ5Ppnc9FSa1e2l/rMi2xnWNngqK3WSgfNhodNc2HUy2Vy5O/5eeOpOS6VZRVYf0e12n68/ro/b+v4OnAN1Mdej098bf9Xl/ao7yeT+B+5rLsl0Re7qAAAAAElFTkSuQmCC",Q="/finance/assets/usa-flag-icon-Cyljem-0.png",j={class:"currency-selector"};function P(c,e,d,U,E,Y){const I=g("el-tag"),p=g("el-radio-button"),v=g("el-radio-group");return S(),b("div",j,[s(v,{modelValue:c.selectedCurrency,"onUpdate:modelValue":e[0]||(e[0]=f=>c.selectedCurrency=f),onChange:c.updateCurrency},{default:a(()=>[s(p,{value:"BYN"},{default:a(()=>[s(I,{type:"success"},{default:a(()=>e[1]||(e[1]=[r("div",null,[r("img",{src:T,alt:"Беларусь"}),u(" BYN ")],-1)])),_:1})]),_:1}),s(p,{value:"RUB"},{default:a(()=>[s(I,{type:"warning"},{default:a(()=>e[2]||(e[2]=[r("div",null,[r("img",{src:H,alt:"Россия"}),u(" RUB ")],-1)])),_:1})]),_:1}),s(p,{value:"USD"},{default:a(()=>[s(I,{type:"info"},{default:a(()=>e[3]||(e[3]=[r("div",null,[r("img",{src:Q,alt:"США",class:"flag-usa"}),u(" USD ")],-1)])),_:1})]),_:1})]),_:1},8,["modelValue","onChange"])])}const Z=D(O,[["render",P]]),q={class:"settings-page"},$={class:"settings-page__exit"},ee={key:2},ae=w({__name:"SettingsView",setup(c){const e=B(),d=K(),U=n=>new Intl.NumberFormat("ru-RU").format(n),E=m(()=>{var n,t;return(t=(n=e.user)==null?void 0:n.created_at)==null?void 0:t.slice(0,10).split("-").reverse().join(".")}),Y=m(()=>{var n;return(n=e.user)==null?void 0:n.email}),I=m(()=>e.earnings.slice().sort((n,t)=>{const l=e.months.findIndex(o=>o.label===n.month);return e.months.findIndex(o=>o.label===t.month)-l})),p=m(()=>I.value.map(n=>n.month).reverse()),v=m(()=>I.value.map(n=>n.amount).reverse()),f=m(()=>e.lastYearEarnings.filter(n=>n.year===new Date().getFullYear()-1).slice().sort((n,t)=>{const l=e.months.findIndex(o=>o.label===n.month);return e.months.findIndex(o=>o.label===t.month)-l})),y=m(()=>f.value.map(n=>n.month).reverse()),L=m(()=>f.value.map(n=>n.amount).reverse()),z=m(()=>{const n=e.expenses.reduce((t,l)=>{const i=new Date(l.date).getFullYear(),o=new Date(l.date).toLocaleString("ru-RU",{month:"long"}).toLowerCase();return i===new Date().getFullYear()-1&&(t[o]=(t[o]||0)+(l.amount||0)),t},{});return y.value.map(t=>n[t.toLowerCase()]||0)}),k=m(()=>f.value.map(n=>{const t=n.month.toLowerCase(),l=e.expenses.filter(i=>{const o=new Date(i.date).getFullYear(),F=new Date(i.date).toLocaleString("ru-RU",{month:"long"}).toLowerCase();if(o===new Date().getFullYear()-1)return F===t}).reduce((i,o)=>i+(o.amount||0),0);return Number(n.amount)-l}).reverse());return G(async()=>{await e.authUser(),await e.getUserEarnings(),await e.getUserExpenses(),await e.fetchBudget(),await e.getLastYearEarnings(),await e.expensesEarningsCategories(),await e.amountExpensesEarningsCategories()}),(n,t)=>{const l=g("el-breadcrumb-item"),i=g("el-breadcrumb"),o=g("el-button"),F=g("el-popconfirm"),M=g("el-card"),N=g("el-empty");return S(),b("div",q,[s(i,{separator:"/"},{default:a(()=>[s(l,{to:{name:"completed-goals-page"}},{default:a(()=>t[1]||(t[1]=[u("Цели")])),_:1}),s(l,{to:{name:"settings-page"}},{default:a(()=>t[2]||(t[2]=[u("Настройки")])),_:1})]),_:1}),s(M,null,{default:a(()=>[t[8]||(t[8]=r("h2",null,"Профиль",-1)),r("p",null,[t[3]||(t[3]=u("email: ")),r("strong",null,h(Y.value),1)]),r("p",null,[t[4]||(t[4]=u("Зарегистрирован: ")),r("span",null,h(E.value),1)]),s(Z),r("div",$,[s(F,{width:"220",title:"Вы уверены что вы хотите выйти?",onConfirm:t[0]||(t[0]=_=>A(e).logout())},{reference:a(()=>[s(o,{type:"danger"},{default:a(()=>t[5]||(t[5]=[u("Выход")])),_:1})]),actions:a(({confirm:_,cancel:W})=>[s(o,{type:"warning",size:"small",onClick:W},{default:a(()=>t[6]||(t[6]=[u("Нет!")])),_:2},1032,["onClick"]),s(o,{type:"danger",size:"small",onClick:_},{default:a(()=>t[7]||(t[7]=[u("Да")])),_:2},1032,["onClick"])]),_:1})])]),_:1}),r("p",null,[t[9]||(t[9]=u("Бюджет: ")),r("strong",null,h(U(Number(A(e).budget.toFixed(2))))+" "+h(A(d).getIcon),1)]),p.value.length?(S(),C(x,{key:0,months:p.value,salaries:v.value,title:"Заработок"},null,8,["months","salaries"])):p.value.length===0?(S(),C(N,{key:1,description:"Вы еще не добавили заработок"})):V("",!0),y.value.length?(S(),b("h3",ee,"Прошлый год")):V("",!0),y.value.length?(S(),C(x,{key:3,months:y.value,salaries:L.value,color:"darkblue",title:`Заработок (${new Date().getFullYear()-1})`},null,8,["months","salaries","title"])):V("",!0),y.value.length?(S(),C(X,{key:4,months:y.value,expenses:z.value,income:k.value,title:"Доходы и расходы"},null,8,["months","expenses","income"])):V("",!0)])}}});export{ae as default};
